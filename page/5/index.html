<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/BlogPro/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/BlogPro/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/BlogPro/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/BlogPro/images/logo.svg" color="#222">

<link rel="stylesheet" href="/BlogPro/css/main.css">


<link rel="stylesheet" href="/BlogPro/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/BlogPro/lib/pace/pace-theme-minimal.min.css">
  <script src="/BlogPro/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"smdegz.github.io","root":"/BlogPro/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="这里是何锦祥的博客，记录生活点滴，分享思考与感悟。">
<meta property="og:type" content="website">
<meta property="og:title" content="何锦祥 博客">
<meta property="og:url" content="https://smdegz.github.io/BlogPro/page/5/index.html">
<meta property="og:site_name" content="何锦祥 博客">
<meta property="og:description" content="这里是何锦祥的博客，记录生活点滴，分享思考与感悟。">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="生活, 思考, 感悟, 分享">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://smdegz.github.io/BlogPro/page/5/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>何锦祥 博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
    <a target="_blank" rel="noopener" href="https://github.com/SMDegz" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/BlogPro/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">何锦祥 博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">你知道的越多 你不知道的也就越多</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/BlogPro/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/BlogPro/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/BlogPro/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/BlogPro/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/BlogPro/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smdegz.github.io/BlogPro/2023/06/04/%E5%85%A8%E6%A0%88%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/4%E3%80%81WebApi%E8%B0%83%E4%BC%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/BlogPro/images/Wx.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="这里是何锦祥的博客，记录生活点滴，分享思考与感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="何锦祥 博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/BlogPro/2023/06/04/%E5%85%A8%E6%A0%88%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/4%E3%80%81WebApi%E8%B0%83%E4%BC%98/" class="post-title-link" itemprop="url">4、WebApi调优</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-06-04 10:48:57" itemprop="dateCreated datePublished" datetime="2023-06-04T10:48:57+08:00">2023-06-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-28 22:17:23" itemprop="dateModified" datetime="2024-01-28T22:17:23+08:00">2024-01-28</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/BlogPro/2023/06/04/%E5%85%A8%E6%A0%88%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/4%E3%80%81WebApi%E8%B0%83%E4%BC%98/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/BlogPro/2023/06/04/%E5%85%A8%E6%A0%88%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/4%E3%80%81WebApi%E8%B0%83%E4%BC%98/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="正常查询"><a href="#正常查询" class="headerlink" title="正常查询"></a>正常查询</h1><ul>
<li>普通数据库查询<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[HttpGet]</span><br><span class="line">public ActionResult&lt;IEnumerable&lt;Seckill&gt;&gt; GetSeckills()</span><br><span class="line">&#123;</span><br><span class="line">    // 1、业务信息</span><br><span class="line">    Console.WriteLine(&quot;查询秒杀商品信息&quot;);</span><br><span class="line">    // 2、查询数据库</span><br><span class="line">    //List&lt;Seckill&gt; seckills = SeckillService.GetSeckills().ToList();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="本地缓存"><a href="#本地缓存" class="headerlink" title="本地缓存"></a>本地缓存</h1><ul>
<li><p>引入 Microsoft.Extensions.Caching.Memory 包</p>
</li>
<li><p>修改 Startup 类的 ConfigureServices 方法，注册本地缓存</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 6、添加本缓存依赖到IOC</span><br><span class="line">services.AddMemoryCache();</span><br></pre></td></tr></table></figure>
</li>
<li><p>控制器修改代码，对数据进行缓存</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">private readonly IMemoryCache memoryCache;// 本地缓存</span><br><span class="line">  public SeckillsController(IMemoryCache memoryCache)</span><br><span class="line">  &#123;</span><br><span class="line">      this.memoryCache = memoryCache;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> [HttpGet]</span><br><span class="line"> public ActionResult&lt;IEnumerable&lt;Seckill&gt;&gt; GetSeckills()</span><br><span class="line"> &#123;</span><br><span class="line">        Console.WriteLine(&quot;获取秒杀数据&quot;);</span><br><span class="line">        List&lt;Seckill&gt; seckills = null;</span><br><span class="line">        bool flag = memoryCache.TryGetValue&lt;List&lt;Seckill&gt;&gt;(&quot;seckills&quot;, out seckills);</span><br><span class="line">        if (!flag)</span><br><span class="line">        &#123;</span><br><span class="line">            // 1.1 查询数据库</span><br><span class="line">            seckills = SeckillService.GetSeckills().ToList();</span><br><span class="line">            // 1.2 添加到缓存</span><br><span class="line">            MemoryCacheEntryOptions memoryCacheEntryOptions = new MemoryCacheEntryOptions();</span><br><span class="line">            // 1、过期时间(保证数据和源头一致)</span><br><span class="line">            memoryCacheEntryOptions.AbsoluteExpirationRelativeToNow = TimeSpan.FromSeconds(3);</span><br><span class="line">            // 2、设置缓存量大小。(保证系统不影响其他操作)</span><br><span class="line">            memoryCacheEntryOptions.SetSize(1024);</span><br><span class="line">            // 3、方案：使用异步更新。</span><br><span class="line">            memoryCacheEntryOptions.RegisterPostEvictionCallback((key, value, reason, state) =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                // 1、key = seckills</span><br><span class="line">                // 2、value = List&lt;Seckill&gt;</span><br><span class="line">                // 3、reason = 回收的原因</span><br><span class="line">                // 4、state = 是否成功，是否失败</span><br><span class="line">                Console.WriteLine($&quot;缓存自动失效：key:&#123;key&#125;,value:&#123;value&#125;,reason:&#123;reason&#125;,state:&#123;state&#125;&quot;);</span><br><span class="line"></span><br><span class="line">                // 1、查询数据库的代码。</span><br><span class="line">                // 自动同步：</span><br><span class="line">                // 1、根据key查询数据库，查询秒杀商品数据</span><br><span class="line">                // 2、然后把查询秒杀商品数据存储到数据库中。</span><br><span class="line">                // 扩展：数据异构形式。</span><br><span class="line">            &#125;);</span><br><span class="line">            // 4、如果数据量缓存数据量，比较大。1000条数据</span><br><span class="line">            //    都会设置过期时间。</span><br><span class="line"></span><br><span class="line">            // 5、优先级设置。</span><br><span class="line">            memoryCacheEntryOptions.Priority = CacheItemPriority.High;</span><br><span class="line"></span><br><span class="line">            memoryCache.Set&lt;List&lt;Seckill&gt;&gt;(&quot;seckills&quot;, seckills, memoryCacheEntryOptions);</span><br><span class="line">        &#125;</span><br><span class="line">        return seckills;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="分布式缓存"><a href="#分布式缓存" class="headerlink" title="分布式缓存"></a>分布式缓存</h1><ul>
<li><p>引入 Microsoft.Extensions.Caching.Redis 包</p>
</li>
<li><p>修改 Startup 类的 ConfigureServices 方法，注册redis分布式缓存</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 7、添加分布式缓存依赖到IOC容器</span><br><span class="line">services.AddDistributedRedisCache(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    options.Configuration = &quot;localhost:6379&quot;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>控制器修改代码，对数据进行缓存</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">private readonly IDistributedCache distributedCache; // 分布式缓存</span><br><span class="line">  public SeckillsController(IDistributedCache distributedCache)</span><br><span class="line">  &#123;</span><br><span class="line">      this.distributedCache = distributedCache;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  [HttpGet]</span><br><span class="line"> public ActionResult&lt;IEnumerable&lt;Seckill&gt;&gt; GetSeckills()</span><br><span class="line"> &#123;</span><br><span class="line">         #region 3、分布式缓存</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(&quot;获取秒杀数据&quot;);</span><br><span class="line">            // 1、先查询redis分布式缓存</span><br><span class="line">            string seckillsString = distributedCache.GetString(&quot;seckills&quot;);</span><br><span class="line">            List&lt;Seckill&gt; seckills = null;</span><br><span class="line">            if (string.IsNullOrEmpty(seckillsString))</span><br><span class="line">            &#123;</span><br><span class="line">                // 1.1 查询数据库</span><br><span class="line">                seckills = SeckillService.GetSeckills().ToList();</span><br><span class="line">                seckillsString = JsonConvert.SerializeObject(seckills);</span><br><span class="line"></span><br><span class="line">                // 设置过期的时间。</span><br><span class="line">                var distributedCacheEntryOptions = new DistributedCacheEntryOptions();</span><br><span class="line">                distributedCacheEntryOptions.AbsoluteExpirationRelativeToNow = TimeSpan.FromDays(3);</span><br><span class="line">                // 1.2 存储到redis中</span><br><span class="line">                distributedCache.SetString(&quot;seckills&quot;, seckillsString, distributedCacheEntryOptions);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            // 1.3反序列化成对象</span><br><span class="line">            seckills = JsonConvert.DeserializeObject&lt;List&lt;Seckill&gt;&gt;(seckillsString);</span><br><span class="line">            return seckills;</span><br><span class="line">        &#125;</span><br><span class="line">        #endregion</span><br><span class="line"> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="相应数据压缩"><a href="#相应数据压缩" class="headerlink" title="相应数据压缩"></a>相应数据压缩</h1><ul>
<li><p>引入 Microsoft.AspNetCore.ResponseCompression 包</p>
</li>
<li><p>修改 Startup 类的 Configure 方法，开启响应数据压缩</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> // 1、开启响应数据压缩</span><br><span class="line">app.UseResponseCompression();</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改 Startup 类的 ConfigureServices 方法，注册redis分布式缓存</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// 11、添加响应数据压缩</span><br><span class="line">services.AddResponseCompression(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    // 1、默认之支持http数据压缩</span><br><span class="line">    options.EnableForHttps = true;</span><br><span class="line"></span><br><span class="line">    // 2、指定数据类型数据压缩</span><br><span class="line">    options.MimeTypes = new[]</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;application/json; charset=utf-8&quot;,</span><br><span class="line">        &quot;application/xml; charset=utf-8&quot;</span><br><span class="line">    &#125;;</span><br><span class="line">    options.Providers.Add&lt;GzipCompressionProvider&gt;();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smdegz.github.io/BlogPro/2023/06/03/%E5%85%A8%E6%A0%88%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/3%E3%80%81Nginx%E8%B0%83%E4%BC%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/BlogPro/images/Wx.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="这里是何锦祥的博客，记录生活点滴，分享思考与感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="何锦祥 博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/BlogPro/2023/06/03/%E5%85%A8%E6%A0%88%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/3%E3%80%81Nginx%E8%B0%83%E4%BC%98/" class="post-title-link" itemprop="url">2、Nginx调优</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-06-03 10:48:57" itemprop="dateCreated datePublished" datetime="2023-06-03T10:48:57+08:00">2023-06-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-30 00:40:18" itemprop="dateModified" datetime="2024-01-30T00:40:18+08:00">2024-01-30</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/BlogPro/2023/06/03/%E5%85%A8%E6%A0%88%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/3%E3%80%81Nginx%E8%B0%83%E4%BC%98/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/BlogPro/2023/06/03/%E5%85%A8%E6%A0%88%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/3%E3%80%81Nginx%E8%B0%83%E4%BC%98/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-37.png" alt="Alt text"></p>
<ul>
<li>配置Nginx 静态资源文件路径</li>
<li>#expires 过期时间</li>
<li>#ETag  在HTTP缓存中的作用是帮助客户端验证资源是否发生变化，从而避免无谓的资源传输，减少带宽的浪费。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">location ~ \.(htm|gif|jpg|jpeg|bmp|png|css|js|ico)$ &#123;</span><br><span class="line">    root D:/work/net/nginx/YDT.EBusiness.StaticResource/wwwroot;</span><br><span class="line">    #expires 10d;</span><br><span class="line">    #etag off;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h1 id="1-OpenResty"><a href="#1-OpenResty" class="headerlink" title="1. OpenResty"></a>1. OpenResty</h1><p>OpenResty是一个基于Nginx的可扩展的Web平台，它整合了Nginx服务器和一系列的模块，其中最突出的是LuaJIT，使得开发人员可以使用Lua脚本语言扩展Nginx的功能。OpenResty的主要特点包括：</p>
<p>高性能： 基于Nginx的高性能特性，加上使用LuaJIT作为扩展语言，能够实现非常快速的处理和响应。</p>
<p>可扩展性： 支持通过Lua脚本自定义和扩展Nginx的功能，方便开发者根据需求定制化配置。</p>
<p>集成性： OpenResty集成了大量的Nginx模块和第三方模块，提供了丰富的功能集合。</p>
<h1 id="2-数据异构"><a href="#2-数据异构" class="headerlink" title="2. 数据异构"></a>2. 数据异构</h1><p>数据异构是指在数据处理过程中，将不同种类或格式的数据整合在一起，使其能够被共同使用。这可以包括不同数据库之间的数据整合、不同数据格式之间的转换等。</p>
<h1 id="3-允许数据过期时候"><a href="#3-允许数据过期时候" class="headerlink" title="3. 允许数据过期时候"></a>3. 允许数据过期时候</h1><p>允许数据过期是指在缓存系统中，允许缓存的数据拥有一个设定的过期时间。一旦超过过期时间，缓存的数据将被认为是失效的，需要重新从数据源获取新的数据。</p>
<p>多级缓存<br>多级缓存是一种层次化的缓存结构，通常包括多个层次的缓存存储，每个层次的缓存具有不同的特性和过期策略。典型的多级缓存包括：</p>
<h1 id="1-多个本地缓存"><a href="#1-多个本地缓存" class="headerlink" title="1. 多个本地缓存"></a>1. 多个本地缓存</h1><p>一级缓存： 通常是内存中的缓存，响应速度最快，用于存储经常访问的数据。</p>
<p>二级缓存： 可以是磁盘缓存或其他存储介质，用于存储一些相对不那么频繁访问但仍然需要缓存的数据。</p>
<h1 id="2-设置过期时间不一致"><a href="#2-设置过期时间不一致" class="headerlink" title="2. 设置过期时间不一致"></a>2. 设置过期时间不一致</h1><p>一级缓存过期时间较短： 因为一级缓存通常是内存，空间有限，过期时间较短可以确保及时释放内存。</p>
<p>二级缓存过期时间相对较长： 由于二级缓存一般是磁盘或其他持久化存储，可以存储相对更久的时间，减少频繁从数据源获取数据的次数。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smdegz.github.io/BlogPro/2023/06/02/%E5%85%A8%E6%A0%88%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/2%E3%80%81CDN%E8%B0%83%E4%BC%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/BlogPro/images/Wx.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="这里是何锦祥的博客，记录生活点滴，分享思考与感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="何锦祥 博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/BlogPro/2023/06/02/%E5%85%A8%E6%A0%88%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/2%E3%80%81CDN%E8%B0%83%E4%BC%98/" class="post-title-link" itemprop="url">2、CDN调优</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-06-02 10:48:57" itemprop="dateCreated datePublished" datetime="2023-06-02T10:48:57+08:00">2023-06-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-30 00:40:18" itemprop="dateModified" datetime="2024-01-30T00:40:18+08:00">2024-01-30</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/BlogPro/2023/06/02/%E5%85%A8%E6%A0%88%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/2%E3%80%81CDN%E8%B0%83%E4%BC%98/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/BlogPro/2023/06/02/%E5%85%A8%E6%A0%88%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/2%E3%80%81CDN%E8%B0%83%E4%BC%98/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="CDN课件"><a href="#CDN课件" class="headerlink" title="CDN课件"></a>CDN课件</h1><blockquote>
<p>CDN，即内容分发网络，是构建在现有网络基础之上的智能虚拟网络，依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使用户就近获取所需内容，降低网络拥塞，提高用户访问响应速度和命中率。通常情况下，CDN的关键技术主要有内容存储和分发技术。（引自©百度百科：CDN）<br>CDN的搭建方式有很多种，并且所使用的软件也有很多种，在本文中以老牌的squid为例进行搭建和实验。</p>
</blockquote>
<h1 id="本实验CDN拓扑"><a href="#本实验CDN拓扑" class="headerlink" title="本实验CDN拓扑"></a>本实验CDN拓扑</h1><blockquote>
<p>在本文中，旨在通过nginx+squid这样的方式搭建一个简易的CDN服务器，用于缓存源服务器上的内容，从而提高达到提高访问速度和流量分摊的目的，我们使用两台服务器进行实验，其中一台安装nginx充当源服务器，另一台则是安装nginx和squid充当CDN缓存服务器，相关拓扑如下：<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-30.png" alt="Alt text"></p>
</blockquote>
<h1 id="3、-配置步骤"><a href="#3、-配置步骤" class="headerlink" title="3、 配置步骤"></a>3、 配置步骤</h1><p>3.1、网站源服务器（操作系统为centos）<br>（1）安装nginx</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install nginx -y</span><br></pre></td></tr></table></figure>
<p>（2）修改nginx的初始页面，以便区分</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;This is test webpage!!!!&#x27; &gt; /var/www/html/index.nginx-debian.html</span><br></pre></td></tr></table></figure>
<p>（3）重启nginx</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart nginx</span><br></pre></td></tr></table></figure>
<ul>
<li>需要注意的是，debian默认的防火墙为iptables，因为该防火墙默认是没有规则的，因此不用专门关闭。</li>
</ul>
<blockquote>
<p>上述配置完成后，客户端输入网站源服务器的IP地址，可以看到访问是正常的如下图所示：<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-31.png" alt="Alt text"></p>
</blockquote>
<h3 id="CDN服务器（操作系统为CentOS7-6）"><a href="#CDN服务器（操作系统为CentOS7-6）" class="headerlink" title="CDN服务器（操作系统为CentOS7.6）"></a>CDN服务器（操作系统为CentOS7.6）</h3><p>针对于CDN服务器，相应的部署步骤如下：</p>
<p>（1）关闭防火墙以及防火墙自启动，也可写入具体的安全策略至防火墙</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl disable firewalld</span><br><span class="line">systemctl stop firewalld</span><br></pre></td></tr></table></figure>
<p>（2）安装nginx和squid</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install nginx -y</span><br><span class="line">yum install squid -y</span><br></pre></td></tr></table></figure>
<p>（3）输入命令“vim &#x2F;etc&#x2F;squid&#x2F;squid.conf”，修改该配置文件，增加如下图红框中所示的内容，以达到将squid缓存代理服务指向网站源服务器的IP地址和端口（192.168.80.135:80）之目的<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-32.png" alt="Alt text"><br>（4）输入命令“vim &#x2F;etc&#x2F;nginx&#x2F;nginx.conf”，修改该配置文件，在server结构体下，增加如下图红框中所示的内容，以达到CDN上的nginx指向squid代理服务（<strong>默认监听端口是3128</strong>）之目的<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-33.png" alt="Alt text"><br>（5）配置完成后，重启nginx和squid</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart nginx</span><br><span class="line">systemctl restart squid</span><br></pre></td></tr></table></figure>

<p>（6）输入以下命令修改SELinux安全上下文的布尔值，如果在CentOS上遗失此步骤，会出现因为SELinux的httpd_can_network_connect模块阻拦，而导致nginx和squid无法建立通信，缓存不到网站源服务器的资源，最终使得客户端访问CDN服务器时报“<strong>502 bad Gateway</strong>”错误，如下图<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-34.png" alt="Alt text"><br>输入命令“setsebool -P httpd_can_network_connect 1”后，然后在客户端的浏览器上输入CDN服务器的IP地址192.168.80.136，发现可以成功访问到网站源服务器（192.168.80.135）上的页面，通过浏览器的开发者工具也可以看到访问过程中经过了squid，说明此时CDN服务器缓存成功<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-36.png" alt="Alt text"><br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-35.png" alt="Alt text"></p>
<h1 id="4、附：nginx和squid的配置文件"><a href="#4、附：nginx和squid的配置文件" class="headerlink" title="4、附：nginx和squid的配置文件"></a>4、附：nginx和squid的配置文件</h1><ul>
<li>4.1、&#x2F;etc&#x2F;nginx&#x2F;nginx.conf<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line"># For more information on configuration, see:</span><br><span class="line">#   * Official English Documentation: http://nginx.org/en/docs/</span><br><span class="line">#   * Official Russian Documentation: http://nginx.org/ru/docs/</span><br><span class="line"></span><br><span class="line">user nginx;</span><br><span class="line">worker_processes auto;</span><br><span class="line">error_log /var/log/nginx/error.log;</span><br><span class="line">pid /run/nginx.pid;</span><br><span class="line"></span><br><span class="line"># Load dynamic modules. See /usr/share/doc/nginx/README.dynamic.</span><br><span class="line">include /usr/share/nginx/modules/*.conf;</span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections 1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class="line">                      &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class="line">                      &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class="line"></span><br><span class="line">    access_log  /var/log/nginx/access.log  main;</span><br><span class="line"></span><br><span class="line">    sendfile            on;</span><br><span class="line">    tcp_nopush          on;</span><br><span class="line">    tcp_nodelay         on;</span><br><span class="line">    keepalive_timeout   65;</span><br><span class="line">    types_hash_max_size 4096;</span><br><span class="line"></span><br><span class="line">    include             /etc/nginx/mime.types;</span><br><span class="line">    default_type        application/octet-stream;</span><br><span class="line"></span><br><span class="line">    # Load modular configuration files from the /etc/nginx/conf.d directory.</span><br><span class="line">    # See http://nginx.org/en/docs/ngx_core_module.html#include</span><br><span class="line">    # for more information.</span><br><span class="line">    include /etc/nginx/conf.d/*.conf;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        #listen       [::]:80;</span><br><span class="line">        #server_name  _;</span><br><span class="line">        #root         /usr/share/nginx/html;</span><br><span class="line"></span><br><span class="line">        # Load configuration files for the default server block.</span><br><span class="line">        #include /etc/nginx/default.d/*.conf;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">                proxy_pass http://127.0.0.1:3128;</span><br><span class="line">        &#125;</span><br><span class="line">        error_page 404 /404.html;</span><br><span class="line">        location = /404.html &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        error_page 500 502 503 504 /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"># Settings for a TLS enabled server.</span><br><span class="line">#</span><br><span class="line">#    server &#123;</span><br><span class="line">#        listen       443 ssl http2;</span><br><span class="line">#        listen       [::]:443 ssl http2;</span><br><span class="line">#        server_name  _;</span><br><span class="line">#        root         /usr/share/nginx/html;</span><br><span class="line">#</span><br><span class="line">#        ssl_certificate &quot;/etc/pki/nginx/server.crt&quot;;</span><br><span class="line">#        ssl_certificate_key &quot;/etc/pki/nginx/private/server.key&quot;;</span><br><span class="line">#        ssl_session_cache shared:SSL:1m;</span><br><span class="line">#        ssl_session_timeout  10m;</span><br><span class="line">#        ssl_ciphers PROFILE=SYSTEM;</span><br><span class="line">#        ssl_prefer_server_ciphers on;</span><br><span class="line">#</span><br><span class="line">#        # Load configuration files for the default server block.</span><br><span class="line">#        include /etc/nginx/default.d/*.conf;</span><br><span class="line">#</span><br><span class="line">#        error_page 404 /404.html;</span><br><span class="line">#            location = /40x.html &#123;</span><br><span class="line">#        &#125;</span><br><span class="line">#</span><br><span class="line">#        error_page 500 502 503 504 /50x.html;</span><br><span class="line">#            location = /50x.html &#123;</span><br><span class="line">#        &#125;</span><br><span class="line">#    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">4.2、/etc/squid/squid.conf</span><br><span class="line">#</span><br><span class="line"># Recommended minimum configuration:</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"># Example rule allowing access from your local networks.</span><br><span class="line"># Adapt to list your (internal) IP networks from where browsing</span><br><span class="line"># should be allowed</span><br><span class="line">acl localnet src 0.0.0.1-0.255.255.255  # RFC 1122 &quot;this&quot; network (LAN)</span><br><span class="line">acl localnet src 10.0.0.0/8             # RFC 1918 local private network (LAN)</span><br><span class="line">acl localnet src 100.64.0.0/10          # RFC 6598 shared address space (CGN)</span><br><span class="line">acl localnet src 169.254.0.0/16         # RFC 3927 link-local (directly plugged) machines</span><br><span class="line">acl localnet src 172.16.0.0/12          # RFC 1918 local private network (LAN)</span><br><span class="line">acl localnet src 192.168.0.0/16         # RFC 1918 local private network (LAN)</span><br><span class="line">acl localnet src fc00::/7               # RFC 4193 local private network range</span><br><span class="line">acl localnet src fe80::/10              # RFC 4291 link-local (directly plugged) machines</span><br><span class="line"></span><br><span class="line">acl SSL_ports port 443</span><br><span class="line">acl Safe_ports port 80          # http</span><br><span class="line">acl Safe_ports port 21          # ftp</span><br><span class="line">acl Safe_ports port 443         # https</span><br><span class="line">acl Safe_ports port 70          # gopher</span><br><span class="line">acl Safe_ports port 210         # wais</span><br><span class="line">acl Safe_ports port 1025-65535  # unregistered ports</span><br><span class="line">acl Safe_ports port 280         # http-mgmt</span><br><span class="line">acl Safe_ports port 488         # gss-http</span><br><span class="line">acl Safe_ports port 591         # filemaker</span><br><span class="line">acl Safe_ports port 777         # multiling http</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># Recommended minimum Access Permission configuration:</span><br><span class="line">#</span><br><span class="line"># Deny requests to certain unsafe ports</span><br><span class="line">http_access deny !Safe_ports</span><br><span class="line"></span><br><span class="line"># Deny CONNECT to other than secure SSL ports</span><br><span class="line">http_access deny CONNECT !SSL_ports</span><br><span class="line"></span><br><span class="line"># Only allow cachemgr access from localhost</span><br><span class="line">http_access allow localhost manager</span><br><span class="line">http_access deny manager</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># We strongly recommend the following be uncommented to protect innocent</span><br><span class="line"># web applications running on the proxy server who think the only</span><br><span class="line"># one who can access services on &quot;localhost&quot; is a local user</span><br><span class="line">#http_access deny to_localhost</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># INSERT YOUR OWN RULE(S) HERE TO ALLOW ACCESS FROM YOUR CLIENTS</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"># Example rule allowing access from your local networks.</span><br><span class="line"># Adapt localnet in the ACL section to list your (internal) IP networks</span><br><span class="line"># from where browsing should be allowed</span><br><span class="line">http_access allow localnet</span><br><span class="line">http_access allow localhost</span><br><span class="line"></span><br><span class="line"># And finally deny all other access to this proxy</span><br><span class="line">#http_access deny all</span><br><span class="line">#http_access allow all</span><br><span class="line"></span><br><span class="line"># Squid normally listens to port 3128</span><br><span class="line">http_port 3128 accel vhost vport</span><br><span class="line">cache_peer 192.168.80.135 parent 80 0 originserver</span><br><span class="line">cache_peer_access 192.168.80.135 allow all</span><br><span class="line"># Uncomment and adjust the following to add a disk cache directory.</span><br><span class="line">cache_dir ufs /var/spool/squid 100 16 256</span><br><span class="line"></span><br><span class="line"># Leave coredumps in the first cache dir</span><br><span class="line">coredump_dir /var/spool/squid</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># Add any of your own refresh_pattern entries above these.</span><br><span class="line">#</span><br><span class="line">refresh_pattern ^ftp:           1440    20%     10080</span><br><span class="line">refresh_pattern ^gopher:        1440    0%      1440</span><br><span class="line">refresh_pattern -i (/cgi-bin/|\?) 0     0%      0</span><br><span class="line">refresh_pattern .               0       20%     4320</span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smdegz.github.io/BlogPro/2023/06/01/%E5%85%A8%E6%A0%88%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/1%E3%80%81DNS%E8%B0%83%E4%BC%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/BlogPro/images/Wx.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="这里是何锦祥的博客，记录生活点滴，分享思考与感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="何锦祥 博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/BlogPro/2023/06/01/%E5%85%A8%E6%A0%88%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/1%E3%80%81DNS%E8%B0%83%E4%BC%98/" class="post-title-link" itemprop="url">1、DNS调优</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-06-01 10:48:57" itemprop="dateCreated datePublished" datetime="2023-06-01T10:48:57+08:00">2023-06-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-30 00:40:18" itemprop="dateModified" datetime="2024-01-30T00:40:18+08:00">2024-01-30</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/BlogPro/2023/06/01/%E5%85%A8%E6%A0%88%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/1%E3%80%81DNS%E8%B0%83%E4%BC%98/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/BlogPro/2023/06/01/%E5%85%A8%E6%A0%88%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/1%E3%80%81DNS%E8%B0%83%E4%BC%98/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="DNS服务器搭建"><a href="#DNS服务器搭建" class="headerlink" title="DNS服务器搭建"></a>DNS服务器搭建</h1><h2 id="DNS介绍"><a href="#DNS介绍" class="headerlink" title="DNS介绍"></a>DNS介绍</h2><h3 id="1-DNS简介"><a href="#1-DNS简介" class="headerlink" title="1.DNS简介"></a>1.DNS简介</h3><blockquote>
<p>DNS，全称 Domain Name System，域名系统。</p>
</blockquote>
<ul>
<li>DNS是将域名解析成IP地址，然后找到IP对应的主机或者服务器。我们平常上网查找资料的时候，总是在浏览器的搜索栏输入 <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> ，当出现百度一下的界面，我们就进行搜索，实际上，在输入 <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> 按下回车键的时候，就已经开始了域名解析的过程，最后解析成一个ip地址，然后找到ip对应的百度的服务器，将页面呈现。</li>
</ul>
<blockquote>
<p>我们可以在windows系统或者Linux系统中 ping 一下<a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> 来看看。<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image.png" alt="Alt text"><br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-1.png" alt="Alt text"><br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-2.png" alt="Alt text"><br>在这里插入图片描述</p>
</blockquote>
<p>2.DNS工作原理<br>DNS服务使用TCP和UDP的53端口，TCP的53端口用于连接DNS服务器，UDP的53端口用于解析DNS。每一级域名长度的限制是63个字符，域名总长度则不能超过253个字符。</p>
<p>DNS分布式系统结构：<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-3.png" alt="Alt text"><br>DNS分为两种解析方式：</p>
<p>正向解析：将域名解析成IP地址<br>逆向解析：将IP地址解析成域名<br>我们通常使用的都是正向解析，即将域名<a target="_blank" rel="noopener" href="http://www.baidu.com输入浏览器,然后解析成ip地址,进行访问./">www.baidu.com输入浏览器，然后解析成IP地址，进行访问。</a></p>
<p>DNS递归查询和迭代查询，简单的来说：</p>
<p>递归查询：就是主机发送DNS请求给本地的DNS服务器，本地服务器有记录，就直接回给主机；若没有，本地的DNS服务器就会以DNS客户端的身份向根服务器发送请求，根没有，就像其他顶级服务器查询，直到查到结果，返还给本地DNS服务器，然后交由本地服务器发给主机，整个过程中，主机只和本地服务器建立连接。<br>迭代查询：主机发送请求给本地服务器，若本地没有，则返回一个可以进行查询的其他的服务器的列表，然后主机再向列表中的服务器进行请求，直至查出，返回给主机。整个过程，主机不知建立和本地服务器的连接，还会和其他的服务器进行连接。<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-4.png" alt="Alt text"></p>
<p>3.DNS的资源记录<br>记录类型：A,AAAA,PTR,SOA,NS,CNAME,MX</p>
<p>SOA：Start Of Authority，起始授权记录；一个区域解析库有且仅能有一个SOA记录，必须位于解析库的第一条记录SOA，是起始授权机构记录，说明了在众多 NS 记录里哪一台才是主要的服务器。在任何DNS记录文件中，都是以SOA ( Startof Authority )记录开始。SOA资源记录表明此DNS名称服务器是该DNS域中数据信息的最佳来源。<br>A：域名解析成IP地址<br>AAAA：IPV6<br>PTR：反向解析，ip地址解析成域名<br>NS：专用于标明当前区域的DNS服务器，服务器类型为域名服务器<br>CNAME：别名记录<br>MX：邮件交换器<br>SOA记录与NS记录的区别：NS记录表示域名服务器记录，用来指定该域名由哪个DNS服务器来进行解析；SOA记录设置一些数据版本和更新以及过期时间等信息。</p>
<p>二、实验<br>1.DNS正向解析实验<br>首先开启两台虚拟机<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-5.png" alt="Alt text"><br>服务器端下载bind和bind-utils，这是dns的服务软件（<strong>yum install -y bind bind-utils</strong>）<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-6.png" alt="Alt text"><br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-7.png" alt="Alt text"><br>查看配置文件位置（<strong>rpm -qc bind</strong>）<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-8.png" alt="Alt text"><br>修改配置文件<br>编辑 &#x2F;etc&#x2F;named.conf 文件<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-9.png" alt="Alt text"><br>编辑 &#x2F;etc&#x2F;named.rfc1912.zones 文件<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-10.png" alt="Alt text"><br>进入 &#x2F;var&#x2F;named 目录，新建一个 yyh.com.zone 文件，这个名字熟悉吧，就是1912文件中 file 的参数<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-11.png" alt="Alt text"><br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-12.png" alt="Alt text"><br>编辑网卡文件（<strong>vim &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-ens33</strong>）<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-13.png" alt="Alt text"><br>重启network和named服务（<strong>systemctl restart network &amp;&amp; systemctl restart named</strong>）<br>（注：先关闭防火墙（systemctl stop firewalld &amp;&amp; setenforce 0））<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-14.png" alt="Alt text"><br>使用客户端测试<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-15.png" alt="Alt text"><br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-16.png" alt="Alt text"><br>2.反向解析<br>具体步骤和正向解析一样的，只是将 &#x2F;etc&#x2F;named.rfc1912.zone 和 &#x2F;var&#x2F;named&#x2F;yyh.com.zone 文件修改一下就行，我就只上图了，不做过多解释。<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-17.png" alt="Alt text"></p>
<p><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-18.png" alt="Alt text"></p>
<p><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-19.png" alt="Alt text"><br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-20.png" alt="Alt text"></p>
<p>3.主从服务器配置<br>这时，我们需要再建一台虚拟机，做dns备份服务器。<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-21.png" alt="Alt text"><br>如图，7-1 和 7-2 都要安装bind 和 bind-utils</p>
<p>主服务器，即7-1上的配置不用动</p>
<p>从服务器配置：</p>
<p>修改 &#x2F;etc&#x2F;named.conf 文件<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-22.png" alt="Alt text"><br>修改 &#x2F;etc&#x2F;named.rfc1912.zone 文件<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-23.png" alt="Alt text"><br>从服务器从重启服务，查看 &#x2F;var&#x2F;named&#x2F;slaves目录下的文件<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-24.png" alt="Alt text"><br>测试<br>将7-4客户端网卡配置更改，dns1为主服务器，dns2为从服务器<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-25.png" alt="Alt text"><br>测试1（主从都没down）<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-26.png" alt="Alt text"><br>测试2（主down）<br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-27.png" alt="Alt text"><br><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-28.png" alt="Alt text"><br>缓存服务器配置<br>forwarders{218.30.19.40; };</p>
<p>也可以通过以下选项让服务器转发所有dns查询到forwarders服务器；</p>
<p>forward only;</p>
<p><img src="/BlogPro/images%E8%B0%83%E4%BC%98/image-29.png" alt="Alt text"></p>
<p>三、总结<br>每次首先要干的务必关掉防火墙（systemctl stop firewalld &amp;&amp; setenforce 0）<br>每次修改完配置文件，务必重启相关服务<br>一定要细心，配置文件中错一点，服务都跑不起来<br>网卡配置文件中的dns地址务必填写正确</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smdegz.github.io/BlogPro/2023/05/03/%E4%BA%91%E5%BC%80%E5%8F%91/3%E3%80%81%E9%98%BF%E9%87%8C%E4%BA%91Devops/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/BlogPro/images/Wx.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="这里是何锦祥的博客，记录生活点滴，分享思考与感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="何锦祥 博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/BlogPro/2023/05/03/%E4%BA%91%E5%BC%80%E5%8F%91/3%E3%80%81%E9%98%BF%E9%87%8C%E4%BA%91Devops/" class="post-title-link" itemprop="url">3、阿里云Devops</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-05-03 10:48:57" itemprop="dateCreated datePublished" datetime="2023-05-03T10:48:57+08:00">2023-05-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-30 10:23:03" itemprop="dateModified" datetime="2024-01-30T10:23:03+08:00">2024-01-30</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/BlogPro/2023/05/03/%E4%BA%91%E5%BC%80%E5%8F%91/3%E3%80%81%E9%98%BF%E9%87%8C%E4%BA%91Devops/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/BlogPro/2023/05/03/%E4%BA%91%E5%BC%80%E5%8F%91/3%E3%80%81%E9%98%BF%E9%87%8C%E4%BA%91Devops/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li><p>创建阿里云DevOps平台<br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-21.png" alt="Alt text"><br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-22.png" alt="Alt text"></p>
</li>
<li><p>上传项目文件到阿里云DevOps平台<br>  -复制DevOps提供的远程代码仓库地址<br>  <img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-24.png" alt="Alt text"><br>  <img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-23.png" alt="Alt text"></p>
<ul>
<li>git推送<br>  <img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-25.png" alt="Alt text"></li>
<li>创建流水线<br>  <img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-26.png" alt="Alt text"><br>  <img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-27.png" alt="Alt text"><ul>
<li>选择项目代码源<br>  <img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-28.png" alt="Alt text"></li>
<li>.Net Core构建<br>  <img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-29.png" alt="Alt text"><br>  <img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-30.png" alt="Alt text"></li>
<li>创建部署任务（云主机、配置下载路径）<br>  <img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-31.png" alt="Alt text"></li>
<li>阿里云devOps自动构建<br>  <img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-32.png" alt="Alt text"></li>
<li>阿里云DevOps自动部署<br>  <img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-33.png" alt="Alt text"></li>
</ul>
</li>
<li>设置Webhook触发<br>  <img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-35.png" alt="Alt text"><br>  <img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-34.png" alt="Alt text"></li>
</ul>
</li>
</ul>
<h1 id="设置Docker部署-（如果项目：微服务。项目数量非常多。不是直接部署到Linux。部署到Docker中，k8s中。）"><a href="#设置Docker部署-（如果项目：微服务。项目数量非常多。不是直接部署到Linux。部署到Docker中，k8s中。）" class="headerlink" title="设置Docker部署 （如果项目：微服务。项目数量非常多。不是直接部署到Linux。部署到Docker中，k8s中。）"></a>设置Docker部署 （如果项目：微服务。项目数量非常多。不是直接部署到Linux。部署到Docker中，k8s中。）</h1><p><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-36.png" alt="Alt text"></p>
<h2 id="1步"><a href="#1步" class="headerlink" title="1步"></a>1步</h2><ul>
<li><p>1、发布项目  手动 </p>
</li>
<li><p>2、发布项目上传 手动 </p>
</li>
<li><p>3、生成Docker镜像 手动</p>
</li>
</ul>
<p>​     docker build -t .</p>
<ul>
<li>4、运行镜像，得到容器。 手动</li>
</ul>
<p>​    docker run xxxx</p>
<ul>
<li><p>运行项目效率低。</p>
</li>
<li><p>1、方案：自动</p>
</li>
<li><p>CI&#x2F;CD 。jenkins。</p>
</li>
</ul>
<h2 id="2步："><a href="#2步：" class="headerlink" title="2步："></a>2步：</h2><h3 id="下载镜像"><a href="#下载镜像" class="headerlink" title="下载镜像"></a>下载镜像</h3><p>docker pull registry.cn-beijing.aliyuncs.com&#x2F;ydt_website2&#x2F;website2:v1</p>
<h3 id="容器存在，删除"><a href="#容器存在，删除" class="headerlink" title="容器存在，删除"></a>容器存在，删除</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">containerId=`docker ps -a| grep ydt_website2| awk &#x27;&#123;print $1&#125;&#x27;`</span><br><span class="line"> echo $containerId</span><br><span class="line">  if [ -n &quot;$containerId&quot; ]; then</span><br><span class="line">   docker stop $containerId</span><br><span class="line">   docker rm $containerId</span><br><span class="line">  fi</span><br></pre></td></tr></table></figure>
<h3 id="运行镜像"><a href="#运行镜像" class="headerlink" title="运行镜像"></a>运行镜像</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 5005:80 -d --name ydt_website2 registry.cn-beijing.aliyuncs.com/ydt_website2/website2:v1</span><br></pre></td></tr></table></figure>
<ul>
<li>总结：阿里云完成项目 Docker之间的自动化<ul>
<li>1、codeup。源代码托管</li>
<li>2、流水线。根据源码自动生成镜像，自动运行得到容器。</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smdegz.github.io/BlogPro/2023/05/03/%E4%BA%91%E5%BC%80%E5%8F%91/4%E3%80%81%E6%8A%80%E6%9C%AF%E5%89%8D%E7%9E%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/BlogPro/images/Wx.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="这里是何锦祥的博客，记录生活点滴，分享思考与感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="何锦祥 博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/BlogPro/2023/05/03/%E4%BA%91%E5%BC%80%E5%8F%91/4%E3%80%81%E6%8A%80%E6%9C%AF%E5%89%8D%E7%9E%BB/" class="post-title-link" itemprop="url">4、技术前瞻</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-05-03 10:48:57" itemprop="dateCreated datePublished" datetime="2023-05-03T10:48:57+08:00">2023-05-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-28 14:24:17" itemprop="dateModified" datetime="2024-01-28T14:24:17+08:00">2024-01-28</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/BlogPro/2023/05/03/%E4%BA%91%E5%BC%80%E5%8F%91/4%E3%80%81%E6%8A%80%E6%9C%AF%E5%89%8D%E7%9E%BB/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/BlogPro/2023/05/03/%E4%BA%91%E5%BC%80%E5%8F%91/4%E3%80%81%E6%8A%80%E6%9C%AF%E5%89%8D%E7%9E%BB/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="技术前瞻"><a href="#技术前瞻" class="headerlink" title="技术前瞻"></a>技术前瞻</h1><h2 id="大数据"><a href="#大数据" class="headerlink" title="大数据"></a>大数据</h2><p>大数据技术在处理庞大数据集时发挥重要作用。并发量、数据量和业务量的增加会导致性能瓶颈，因此需要采用分布式系统，如Hadoop、Hive和Spark等，来实现大规模数据的存储和计算。当前已有的技术包括：</p>
<ul>
<li><strong>Hadoop</strong>: 提供分布式存储和计算。</li>
<li><strong>Hive</strong>: 使用类似SQL的查询语言进行大数据分析。</li>
<li><strong>Spark</strong>: 支持实时计算，提高大数据处理效率。</li>
</ul>
<h2 id="人工智能"><a href="#人工智能" class="headerlink" title="人工智能"></a>人工智能</h2><p>人工智能技术通过模拟人类智能，进行数据推荐、行为判断和自动特征提取。神经网络等技术用于自动学习数据特点。当前已有的技术包括：</p>
<ul>
<li><strong>神经网络</strong>: 模拟人脑神经元结构，用于各种数据判断和学习。</li>
<li><strong>Python</strong>: 作为主要的人工智能编程语言，支持丰富的库和框架。</li>
<li><strong>Solidity、Go、C++</strong>: 用于智能合约和底层系统开发。</li>
</ul>
<h2 id="区块链"><a href="#区块链" class="headerlink" title="区块链"></a>区块链</h2><p>区块链技术通过建立信任链来保证数据安全性和隐私。去中心化技术提高了系统的安全性。当前已有的技术包括：</p>
<ul>
<li><strong>挖矿</strong>: 通过算力的竞争来建立区块链，如比特币。</li>
<li><strong>智能合约</strong>: 使用Solidity等语言编写可在区块链上执行的智能合约。</li>
<li><strong>诚信链</strong>: 通过建立基于信任的区块链，确保数据的不可篡改性。</li>
</ul>
<h2 id="物联网"><a href="#物联网" class="headerlink" title="物联网"></a>物联网</h2><p>物联网技术通过连接各种物体，实现智能化。上位机技术和嵌入式技术是物联网的关键组成部分。当前已有的技术包括：</p>
<ul>
<li><strong>上位机技术</strong>: 用于监控和管理物联网设备。</li>
<li><strong>嵌入式技术</strong>: 使得设备能够嵌入各种物体中，实现智能化功能。</li>
<li><strong>5G技术</strong>: 提供更高的数据传输速度和连接密度，加速物联网的发展。</li>
</ul>
<h2 id="数据安全"><a href="#数据安全" class="headerlink" title="数据安全"></a>数据安全</h2><p>数据安全是当前技术领域的一个重要问题。随着数据量的增加，采用区块链技术是一种解决方案。当前已有的技术包括：</p>
<ul>
<li><strong>区块链</strong>: 通过规则和共识机制确保数据的安全性和不可篡改性。</li>
<li><strong>加密技术</strong>: 用于保护数据的传输和存储安全。</li>
<li><strong>隐私保护技术</strong>: 确保只有数据所有者知晓数据内容，避免隐私泄露。</li>
</ul>
<h2 id="电商系统"><a href="#电商系统" class="headerlink" title="电商系统"></a>电商系统</h2><p>电商系统是一个综合性系统，包括商品、用户、订单和支付等模块。采用http&#x2F;grpc协议、分布式架构和微服务体系来提高系统效率。当前已有的技术包括：</p>
<ul>
<li><strong>微服务架构</strong>: 将系统拆分为独立的服务，提高系统的灵活性和可维护性。</li>
<li><strong>http&#x2F;grpc协议</strong>: 用于不同服务之间的通信。</li>
<li><strong>数据库优化技术</strong>: 提高数据库的查询性能，如索引、分库分表等。</li>
</ul>
<h2 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h2><p>性能优化是大数据、人工智能和区块链等技术中需要解决的关键问题。并发量、数据量和业务量的增加都会影响性能。当前已有的技术包括：</p>
<ul>
<li><strong>分布式计算</strong>: 通过分布式架构提高系统的并发处理能力。</li>
<li><strong>缓存技术</strong>: 使用缓存加速数据的读取和计算。</li>
<li><strong>数据预处理</strong>: 在数据进入系统之前进行处理，提高后续计算的效率。</li>
</ul>
<h2 id="未来趋势"><a href="#未来趋势" class="headerlink" title="未来趋势"></a>未来趋势</h2><p>未来技术发展趋势可能包括6G技术的崭露头角、新的编程语言的出现以及更加智能化的人工智能应用。同时，数据无限化将持续推动技术的创新，对于从业者来说，不断学习和适应新技术是保持竞争力的关键。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smdegz.github.io/BlogPro/2023/05/02/%E4%BA%91%E5%BC%80%E5%8F%91/2%E3%80%81%E9%98%BF%E9%87%8C%E4%BA%91%E5%B9%B3%E5%8F%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/BlogPro/images/Wx.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="这里是何锦祥的博客，记录生活点滴，分享思考与感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="何锦祥 博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/BlogPro/2023/05/02/%E4%BA%91%E5%BC%80%E5%8F%91/2%E3%80%81%E9%98%BF%E9%87%8C%E4%BA%91%E5%B9%B3%E5%8F%B0/" class="post-title-link" itemprop="url">2、阿里云平台</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-05-02 10:48:57" itemprop="dateCreated datePublished" datetime="2023-05-02T10:48:57+08:00">2023-05-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-30 10:23:01" itemprop="dateModified" datetime="2024-01-30T10:23:01+08:00">2024-01-30</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/BlogPro/2023/05/02/%E4%BA%91%E5%BC%80%E5%8F%91/2%E3%80%81%E9%98%BF%E9%87%8C%E4%BA%91%E5%B9%B3%E5%8F%B0/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/BlogPro/2023/05/02/%E4%BA%91%E5%BC%80%E5%8F%91/2%E3%80%81%E9%98%BF%E9%87%8C%E4%BA%91%E5%B9%B3%E5%8F%B0/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="笔记"><a href="#笔记" class="headerlink" title="笔记"></a>笔记</h1><p>总结</p>
<ul>
<li>创建一个新的项目<br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image.png" alt="Alt text"></li>
</ul>
<h1 id="1、创建云主机"><a href="#1、创建云主机" class="headerlink" title="1、创建云主机"></a>1、创建云主机</h1><p><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-1.png" alt="Alt text"><br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-2.png" alt="Alt text"></p>
<h1 id="2、Linux安装-Net5-SDK"><a href="#2、Linux安装-Net5-SDK" class="headerlink" title="2、Linux安装.Net5 SDK"></a>2、Linux安装.Net5 SDK</h1><p>​	条件</p>
<p>​	1、Centos7.6</p>
<p>​	2、.Net5 SDK</p>
<p>​    步骤</p>
<pre><code>- 1. 添加源

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rpm -Uvh https://packages.microsoft.com/config/centos/7/packages-microsoft-prod.rpm</span><br></pre></td></tr></table></figure>

- 2. 安装SDK

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install dotnet-sdk-5.0</span><br></pre></td></tr></table></figure>

- 3. 安装运行时

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install aspnetcore-runtime-5.0</span><br></pre></td></tr></table></figure>

- 4. 测试运行时是否成功

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dotnet --version</span><br><span class="line">5.0.202</span><br></pre></td></tr></table></figure>
</code></pre>
<p>官网地址：</p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/dotnet/core/install/linux-centos">https://docs.microsoft.com/zh-cn/dotnet/core/install/linux-centos</a></p>
<h1 id="3、上传项目发布文件"><a href="#3、上传项目发布文件" class="headerlink" title="3、上传项目发布文件"></a>3、上传项目发布文件</h1><ul>
<li><p>上传发布代码到服务器<br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-3.png" alt="Alt text"></p>
</li>
<li><p>部署项目<br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-5.png" alt="Alt text"></p>
</li>
</ul>
<h1 id="项目托管"><a href="#项目托管" class="headerlink" title="项目托管"></a>项目托管</h1><ul>
<li><p>阿里云选择Web应用托管服务<br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-6.png" alt="Alt text"></p>
<ul>
<li>创建新的应用<br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-7.png" alt="Alt text"></li>
<li>部署环境信息，打包发布文件，并上传<br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-8.png" alt="Alt text"></li>
<li>完成配置<br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-9.png" alt="Alt text"><br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-10.png" alt="Alt text"></li>
<li>阿里云线上数据库<br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-11.png" alt="Alt text"><br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-12.png" alt="Alt text"><br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-13.png" alt="Alt text"></li>
<li>创建数据库的连接账号密码<br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-14.png" alt="Alt text"></li>
<li>设置数据库外网连接<br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-15.png" alt="Alt text"></li>
<li>修改项目的数据库连接地址<br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-16.png" alt="Alt text"></li>
<li>进行项目数据库迁移命令<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dotnet ef migration add aliyun</span><br><span class="line">dotnet ef database update aliyun</span><br></pre></td></tr></table></figure></li>
<li>回到web应用托管服务，创建新的应用实例<br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-17.png" alt="Alt text"></li>
<li>阿里云Redis<br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-18.png" alt="Alt text"><br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-19.png" alt="Alt text"></li>
<li>创建Redis交换机<br><img src="/BlogPro/images%E4%BA%91%E5%BC%80%E5%8F%91/image-20.png" alt="Alt text"></li>
</ul>
<p>总结</p>
<p>1、创建云主机</p>
<p>2、安装sdk环境</p>
<p>3、上传项目发布文件</p>
<p>4、自动创建数据库。</p>
<p>web+服务。</p>
</li>
</ul>
<p>5、阿里云云缓存</p>
<p>6、阿里云云SLB</p>
<p>总结</p>
<p>1、使用阿里云如何开发项目</p>
<p>   1、云服务器ECS</p>
<p>   2、云数据库mysql</p>
<p>   3、云nosql数据 redis</p>
<p>   4、web+服务  ，自动创建呢？</p>
<p>下一节课：讲解devops。</p>
<p>阿里云：解决了公司效率的问题。个人学习技术的问题</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smdegz.github.io/BlogPro/2023/05/01/%E4%BA%91%E5%BC%80%E5%8F%91/1%E3%80%81%E4%BA%91%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/BlogPro/images/Wx.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="这里是何锦祥的博客，记录生活点滴，分享思考与感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="何锦祥 博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/BlogPro/2023/05/01/%E4%BA%91%E5%BC%80%E5%8F%91/1%E3%80%81%E4%BA%91%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80/" class="post-title-link" itemprop="url">1、云开发基础</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-05-01 10:48:57" itemprop="dateCreated datePublished" datetime="2023-05-01T10:48:57+08:00">2023-05-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-27 16:56:33" itemprop="dateModified" datetime="2024-01-27T16:56:33+08:00">2024-01-27</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/BlogPro/2023/05/01/%E4%BA%91%E5%BC%80%E5%8F%91/1%E3%80%81%E4%BA%91%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/BlogPro/2023/05/01/%E4%BA%91%E5%BC%80%E5%8F%91/1%E3%80%81%E4%BA%91%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="笔记"><a href="#笔记" class="headerlink" title="笔记"></a>笔记</h1><p>总结</p>
<p>1、并发量增大，数据量增大，业务数据量上升，</p>
<p>  开发员上升，业务复杂性上升。</p>
<p>选择：微服务架构解决。</p>
<p>开发上云的思路：</p>
<p>前提：</p>
<p>​    1、大项目 2、用云才划算。</p>
<p>​     2、小项目 用云不划算。</p>
<p>总结</p>
<p>1、分布式项目：直接使用云平台技术（云开发）</p>
<p>2、单体项目：本地开发</p>
<p>全部上云缺陷：</p>
<p>   Docker k8s Linux 全部是别人提供。</p>
<p>1、数据安全问题。</p>
<p>2、公司成本可能不会降低很多问题。</p>
<p>私有云方案：</p>
<p>1、Docker &#x2F; k8s。这两种技术。</p>
<p>  云—-&gt;无限：Docker &#x2F;k8s 可以部署无数个实例。</p>
<p>现在比较成熟。</p>
<p>技术：全部自己维护。经济成本最高</p>
<p>​           所有技术全部自己做。</p>
<p>公有云：全部交给别人。经济成本其次</p>
<p>私有云：自己维护+云平台维护一部分。最经济</p>
<p>​    利用云平台提供的Linux，自己维护Docker k8s。</p>
<p>​    云主机+Docker +k8s私有云。</p>
<p>回顾：</p>
<p>1、开发为什么上云。</p>
<p>2、开发如何上云？</p>
<p>使用：云平台。</p>
<p>1、Azure讲解。可以付费的时候。再进行讲解。 第二期的时候，有录播。</p>
<p>微软MVP Azure云。 MVP。</p>
<p>微软系统架构 MVP。</p>
<p>国内：阿里云：腾讯云。基本使用。就可以。</p>
<p>安排：</p>
<p>1、第二期的讲解。可以先看录播</p>
<p>云平台：花钱找人办事。</p>
<p>核心部分：</p>
<p>1、laaS 基础设施即服务。云主机。</p>
<p>2、PaaS 平台即服务。项目技术。</p>
<p>3、SaaS 软件即服务。自己项目。云主机+sdk环境</p>
<p>扩展部分：</p>
<p>4、FaaS 功能即服务。开发（云主机，环境）云主机+sdk环境（阿里进行了封装）</p>
<p>5、BaaS 区块链即服务。</p>
<p>只是对所有服务的归类。</p>
<h2 id="分布式缓存缺陷是命中率低吗？"><a href="#分布式缓存缺陷是命中率低吗？" class="headerlink" title="分布式缓存缺陷是命中率低吗？"></a>分布式缓存缺陷是命中率低吗？</h2><p>缺陷</p>
<p>1、缓存击穿。redis数据过期。</p>
<p>2、缓存奔溃。redis宕机。</p>
<p>两种方案</p>
<p>1、redis集群。</p>
<p>2、多级缓存。</p>
<h2 id="混合云简单的说下"><a href="#混合云简单的说下" class="headerlink" title="混合云简单的说下"></a>混合云简单的说下</h2><p>多个云平台合在一起。</p>
<p>Azure+阿里云。</p>
<h2 id="SaaS与FaaS-区别是部署平台不一样吗"><a href="#SaaS与FaaS-区别是部署平台不一样吗" class="headerlink" title="SaaS与FaaS,区别是部署平台不一样吗"></a>SaaS与FaaS,区别是部署平台不一样吗</h2><p>Saas是自己部署。</p>
<p>FaaS是别人给你部署。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smdegz.github.io/BlogPro/2023/01/11/ABP%E4%B8%AD%E9%97%B4%E4%BB%B6/ShardingSphere-Proxy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/BlogPro/images/Wx.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="这里是何锦祥的博客，记录生活点滴，分享思考与感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="何锦祥 博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/BlogPro/2023/01/11/ABP%E4%B8%AD%E9%97%B4%E4%BB%B6/ShardingSphere-Proxy/" class="post-title-link" itemprop="url">11、ShardingSphere-Proxy</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-11 10:48:57" itemprop="dateCreated datePublished" datetime="2023-01-11T10:48:57+08:00">2023-01-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-24 14:17:41" itemprop="dateModified" datetime="2024-01-24T14:17:41+08:00">2024-01-24</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/BlogPro/2023/01/11/ABP%E4%B8%AD%E9%97%B4%E4%BB%B6/ShardingSphere-Proxy/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/BlogPro/2023/01/11/ABP%E4%B8%AD%E9%97%B4%E4%BB%B6/ShardingSphere-Proxy/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><ul>
<li><p>下载apache-shardingsphere工具</p>
</li>
<li><p>修改配置文件 confing-sharding.yaml 文件</p>
</li>
<li><p>连接mysql<br>  <img src="/BlogPro/images/18beb1fe3d42793821309c8915dc1caa.png" alt="Alt text"></p>
</li>
<li><p>设置分片规则<br>  <img src="/BlogPro/images/5de6d87acd52b974bd78749787e290a5.png" alt="Alt text"></p>
</li>
<li><p>连接字符串 数据库</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schemaName： ebusiness</span><br></pre></td></tr></table></figure></li>
<li><p>安装 javaJdk</p>
</li>
<li><p>下载mysql-connector- java.jar 驱动</p>
</li>
<li><p>在bin 文件夹进入CMD，启动服务，默认端口3307</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start.bat</span><br></pre></td></tr></table></figure></li>
<li><p>mysql客户端创建新的连接 取名 proxy-3307</p>
</li>
<li><p>在3307执行 创建数据库表Product表 SQL语句</p>
</li>
<li><p>查看3306连接，发现创建了Product0，product1 两个表</p>
</li>
<li><p>配置分表策略<br>  <img src="/BlogPro/images/05658f75c7d480065579104cc54ab370.png" alt="Alt text"></p>
</li>
<li><p>往3307插入两条数据，3306的两个表各插入一条数据</p>
</li>
<li><p>分表操作流程<br>  <img src="/BlogPro/images/18f78cd0c075c4db419d96edc5e7e3d5.png" alt="Alt text"></p>
</li>
<li><p>分库操作流程<br>  <img src="/BlogPro/images/bc7fb7e8b950fc3fdc841baf8ebd6482.png" alt="Alt text"><br>  <img src="/BlogPro/images/048663049c4e1eae8cb9a5885ca426ed.png" alt="Alt text"></p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://smdegz.github.io/BlogPro/2023/01/09/ABP%E4%B8%AD%E9%97%B4%E4%BB%B6/ScheduleMaster/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/BlogPro/images/Wx.jpg">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="这里是何锦祥的博客，记录生活点滴，分享思考与感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="何锦祥 博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/BlogPro/2023/01/09/ABP%E4%B8%AD%E9%97%B4%E4%BB%B6/ScheduleMaster/" class="post-title-link" itemprop="url">9、ScheduleMaster 分布式任务调度系统</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-09 10:48:57" itemprop="dateCreated datePublished" datetime="2023-01-09T10:48:57+08:00">2023-01-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-24 14:17:41" itemprop="dateModified" datetime="2024-01-24T14:17:41+08:00">2024-01-24</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/BlogPro/2023/01/09/ABP%E4%B8%AD%E9%97%B4%E4%BB%B6/ScheduleMaster/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/BlogPro/2023/01/09/ABP%E4%B8%AD%E9%97%B4%E4%BB%B6/ScheduleMaster/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><img src="/BlogPro/images/e6c6739ba3d62bdaad383acd0ee9134d.png" alt="Alt text"></p>
<p><img src="/BlogPro/images/a50b3dbca5d56a3b017197a415407006.png" alt="Alt text"></p>
<h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><ul>
<li><p>下载ScheduleMaster 开源项目</p>
</li>
<li><p>到Hos.ScheduleMaster.Web项目的Public文件夹 CMD</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet hos.Schedulemaster.web.dll</span><br></pre></td></tr></table></figure></li>
<li><p>访问schedulemaster<br>  localhost：30000 admin 11111</p>
</li>
<li><p>创建Schedule-master 数据库（Mysql）</p>
</li>
<li><p>创建与MySql的连接</p>
</li>
<li><p>到Hos.schedulemaster.quartzhost&#x2F;public文件夹 CMD<br>  dotnet Hos.schedulemaster.QuartzHost.dll –urls http:&#x2F;&#x2F;*:3000</p>
</li>
<li><p>运行订单微服务</p>
</li>
<li><p>创建任务<br>  <img src="/BlogPro/images/06ff344cd879cbc6c39ab0167ac3a451.png" alt="Alt text"></p>
</li>
<li><p>任务运行流程<br>  <img src="/BlogPro/images/c0a6314a70fa21591edda72aabe9c352.png" alt="Alt text"></p>
</li>
</ul>
<h3 id="运行控制台（非Web）"><a href="#运行控制台（非Web）" class="headerlink" title="运行控制台（非Web）"></a>运行控制台（非Web）</h3><ul>
<li>下载scheduleMaster</li>
<li>Task 类 引入TaskBase 接口</li>
<li>打包控制台，把发布文件的Dll文件压缩</li>
<li>Schedule 创建一个控制台任务，配置参数，并上传压缩包<br>  <img src="/BlogPro/images/62d9d6ae7c2f918ebbc67ecbe91e1606.png" alt="Alt text"></li>
</ul>
<h3 id="根据接口创建任务"><a href="#根据接口创建任务" class="headerlink" title="根据接口创建任务"></a>根据接口创建任务</h3><p><img src="/BlogPro/images/1702ec8d20a30585da719206f8b85f0d.png" alt="Alt text"></p>
<h3 id="Schedule-master-集群-（Work）"><a href="#Schedule-master-集群-（Work）" class="headerlink" title="Schedule master 集群 （Work）"></a>Schedule master 集群 （Work）</h3><ul>
<li>创建多个Work，访问work掉线</li>
<li>进入Hos.schedulemaster.auarzHost&#x2F;public.appsetting.json,修改配置文件<br>  <img src="/BlogPro/images/40f9e16c57a68262a2348466d29c8452.png" alt="Alt text"></li>
<li>CMD执行以下命令<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet Hos.schedule.master.QuarzHost.dll --urls http://*:30002</span><br></pre></td></tr></table></figure></li>
<li>进入管理后台，发型work2已经加载</li>
<li>创建新的任务<br>  Work1，Work2</li>
<li>通过健康监测及故障转移实现<ul>
<li>此时关闭Work1，自动启动Work2</li>
<li>关闭Work2，自动使用Work1</li>
</ul>
</li>
</ul>
<h3 id="Schedule-master-集群-（master）"><a href="#Schedule-master-集群-（master）" class="headerlink" title="Schedule master 集群 （master）"></a>Schedule master 集群 （master）</h3><ul>
<li><p>进入Hos.schedulemaster.web&#x2F;public.appsetting.json<br>  <img src="/BlogPro/images/ffee5424e444f6afc2aa44533c76313e.png" alt="Alt text"></p>
</li>
<li><p>cmd 执行以下命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet Hos.scedulemaster.web.dll --urls https://*:3003</span><br></pre></td></tr></table></figure>
</li>
<li><p>进入管理后台，发现master已加载</p>
</li>
<li><p>下载nginx 并配置<br>  <img src="/BlogPro/images/bbe8f0db0095a75504b670e2b39e00ac.png" alt="Alt text"></p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/BlogPro/page/4/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/BlogPro/">1</a><span class="space">&hellip;</span><a class="page-number" href="/BlogPro/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/BlogPro/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/BlogPro/page/9/">9</a><a class="extend next" rel="next" href="/BlogPro/page/6/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="John Doe"
      src="/BlogPro/images/Wx.jpg">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description">这里是何锦祥的博客，记录生活点滴，分享思考与感悟。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/BlogPro/archives/">
        
          <span class="site-state-item-count">89</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/BlogPro/tags/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/SMDegz" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;SMDegz" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/BlogPro/1522107010@qq.com" title="E-Mail → 1522107010@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://plus.google.com/%E4%B8%8D%E4%BC%9A%E7%BC%96%E7%A8%8B%E7%9A%84%E7%8C%AB" title="Google → https:&#x2F;&#x2F;plus.google.com&#x2F;不会编程的猫" rel="noopener" target="_blank"><i class="fab fa-google fa-fw"></i>Google</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://smdegz.github.io/BlogPro/" title="https:&#x2F;&#x2F;smdegz.github.io&#x2F;BlogPro&#x2F;">smdegz Blog</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/BlogPro/lib/anime.min.js"></script>
  <script src="/BlogPro/lib/velocity/velocity.min.js"></script>
  <script src="/BlogPro/lib/velocity/velocity.ui.min.js"></script>

<script src="/BlogPro/js/utils.js"></script>

<script src="/BlogPro/js/motion.js"></script>


<script src="/BlogPro/js/schemes/pisces.js"></script>


<script src="/BlogPro/js/next-boot.js"></script>


  <script defer src="/BlogPro/lib/three/three.min.js"></script>
    <script defer src="/BlogPro/lib/three/canvas_sphere.min.js"></script>


  




  
<script src="/BlogPro/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'i6ML4c6D9phSdR4vRG7tjH8M-gzGzoHsz',
      appKey     : 'BfRJ9pJSV3u0CAuvm1xEwNL8',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
